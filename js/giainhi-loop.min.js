var giainhi={text:"XXXXXX",chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",lists:[],lastkey:"",click:1,play:1,press:1,ltr:!1,animation:3.5,result:[]},buildListHeader=[];function updateUerWin(i){$.ajax({url:AppURL.giai_nhi_update+i,type:"GET",dataType:"json",cache:!0,complete:function(i){}})}function victoryStep(){$(".chucmung").find("h3").html(giainhi.Fulltext[giainhi.click-2].split(";")[3]);for(var i=[],t=0;t<giainhi.columnTitle.length-4;t++)"true"===giainhi.displayOnResult[t+4]&&i.push('<p class="text-muted click">'+giainhi.titleOnResult[t+4]+giainhi.Fulltext[giainhi.click-2].split(";")[t+4]+"</p>");$(".chucmung .looptext").html(i),$(".quatang").find("img").attr("src",giainhi.imgs),$(".chucmung, .quatang").show(),$(".click").kAnimation({ClassName:"animated fadeIn",Delay:1e3,Forever:!1,DelayForever:100}),setTimeout(function(){$("body").addClass("phaono"),$("#congrats").show(),document.title="✨🌟 Xin chúc mừng! 🌟✨",fancyPopIn(),updateUerWin(giainhi.Fulltext[giainhi.click-2].split(";")[0]),$("#buzzer").get(0).play()},300),setTimeout(function(){giainhi.click<=giainhi.Fulltext.length?($("#getnumautosop").removeAttr("disabled").html("Quay số"),$("#getnumautosop").show()):$("#ketqua").show(),$("body").removeClass("phaono")},2e3)}function passed(){geStopSlot(giainhi.ltr,giainhi.press,giainhi.click,giainhi.text[giainhi.click-2].split(";")[1].split(""))}function getData(){$.ajax({url:AppURL.giai_nhi,type:"GET",dataType:"json",cache:!0,complete:function(i){var t=i.responseJSON.data_giainhi;giainhi.text=t.lists,giainhi.Fulltext=t.lists,giainhi.autotime=t.autotime,giainhi.autostop=t.autostop,giainhi.imgs=t.imgs,giainhi.passed=t.lists[0].split(";")[2],giainhi.columnTitle=t.columnTitle.split(","),giainhi.displayOnResult=t.displayOnResult.toLowerCase().split(","),giainhi.displayOnTable=t.displayOnTable.toLowerCase().split(","),giainhi.titleOnResult=t.titleOnResult.toLowerCase().split(","),"true"===giainhi.passed?(giainhi.click++,$("#getnumautosop").removeAttr("disabled").html("Quay số"),$(".text-kienlong").html("Lần quay "+(giainhi.click-1)+"/"+t.lists.length),victoryStep(),passed()):$(".text-kienlong").html("Lần quay "+giainhi.click+"/"+t.lists.length),t.bgimg&&setTimeout(function(){$("body").css({"background-image":"url("+t.bgimg+")"})},200),t.demo&&DemoMode()}})}function shuffle(i){for(var t,e,n=i.length;0!==n;)e=Math.floor(Math.random()*n),t=i[n-=1],i[n]=i[e],i[e]=t;return i}function sf(){return shuffle(giainhi.chars.split(""))}function createList(i){$("#stopnum").css({cursor:"wait","pointer-events":"none"}).attr("disabled","disabled"),setTimeout(function(){$("#stopnum").css({cursor:"pointer","pointer-events":"initial"}).removeAttr("disabled")},2e3),$(".block").addClass("animated").css({"animation-duration":giainhi.animation+"s"}),$(".block").each(function(){giainhi.lists=[];for(var i=sf(),t=0;t<i.length;t++)giainhi.lists.push("<div class='item'>"+i[t]+"</div>");$(this).html(giainhi.lists)}),i&&setTimeout(function(){$("#getnumautosop").hide()},giainhi.autotime*giainhi.press)}function getRandomKey(){$(".text-kienlong").html("Lần quay "+giainhi.click+"/"+giainhi.Fulltext.length);var i=giainhi.autostop;if(createList(i),"true"===giainhi.text[giainhi.click-1].split(";")[2])giainhi.click++,giainhi.click<=giainhi.Fulltext.length?$("#getnumautosop").removeAttr("disabled").html("Quay số"):$("#getnumautosop").hide(),victoryStep(),passed();else{giainhi.click++,document.title="Đang tìm người may mắn...",$(".stepbystep p").html("Đang quay số..."),$(".chucmung, .quatang").hide(),$("#jackpot").get(0).play();document.getElementById("getnum");var t=document.getElementById("getnumautosop");if(i){giainhi.autotime;var e=giainhi.press;countDown(),t.setAttribute("disabled","disabled");var n=setInterval(function(){stopKey(),--e<=0?clearInterval(n):countDown()},giainhi.autotime)}else $("#getnum").hide(),$("#getnumautosop").hide(),$(".loading").show(),$("#stopnum").show(0)}}function countDown(){var i=giainhi.autotime/1e3,t=document.getElementById("getnumautosop");t.innerHTML="Đang quay";var e=setInterval(function(){(i-=1)<0?clearInterval(e):(document.title="("+i+") - Đang tìm người may mắn...",t.innerHTML="Đang quay")},1e3)}function stopKeyEnd(){$("#jackpot").get(0).pause(),$(".loading").hide(),getlastKey(),victoryStep()}function getlastKey(){$(".block.end").removeClass("animated"),$("#lists .lists .block.end").html("<div class='item'>"+giainhi.lastkey+"</div>"),$(".stepbystep p").html("Quay số hoàn tất!")}function stopKey(){if($("#pot").get(0).play(),gold(giainhi.ltr),setTimeout(function(){$("#pot").get(0).pause()},1e3),$("#stopnum").html("Dừng quay"),giainhi.click>giainhi.press)return stopKeyEnd(),$("#stopnum").hide(),!1}function gold(i){giainhi.lists=[];var t=giainhi.text[giainhi.click-2].split(";")[1].split("");geStopSlot(giainhi.ltr,giainhi.press,giainhi.click,t)}function showList(){$("#showlist").after("<p class='mb-0 h4'>Kết quả quay số đã được lưu vào cơ sở dữ liệu.</p>"),$("#showlist").remove()}function geStopSlot(i,t,e,n){if(i)for(var a=t-(e-1);a<6;a++)$("#lists .lists:nth-child("+(a+1)+") .block").html("<div class='item'>"+n[a]+"</div>").removeClass("animated");else for(a=0;a<e-1+(6-t);a++)$("#lists .lists:nth-child("+(a+1)+") .block").html("<div class='item'>"+n[a]+"</div>").removeClass("animated")}function buildHeader(){buildListHeader.push('<th scope="col">STT</th>');for(var i=0;i<giainhi.columnTitle.length-3;i++)"true"===giainhi.displayOnTable[i+3]&&buildListHeader.push('<th scope="col">'+giainhi.columnTitle[i+3]+"</th>")}function doSearch(){for(var i=giainhi.text,t=[],e=0;e<i.length;e++){var n=[];n.push("<td>"+(e+1)+"</td>");for(var a=0;a<giainhi.columnTitle.length-3;a++)"true"===giainhi.displayOnTable[a+3]&&n.push("<td>"+i[e].split(";")[a+3]+"</td>");var s="<tr>"+n+"<tr>";t.push(s)}$(".table-kienlong thead tr").append(buildListHeader),$(".table-kienlong tbody").append(t),$(".resultbox").show(),$(".getloading").hide()}function ketqua(){$("#lists, .text-kienlong, .boxnone").hide(),$(".getloading").show(),buildHeader(),doSearch()}getData();